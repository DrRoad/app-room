# global constants available to the app
# last update:2016-10-08

# constants required for every app
appName <- 'room'
appTitle <- 'Raumklima'
app_id <- 'eu.ownyourdata.room'
scheduler_id <- 'eu.ownyourdata.scheduler'        

# definition of data structure
currRepoSelect <- ''
appRepos <- list()
appReposDefault <- list(Nagios   = 'eu.ownyourdata.room.nagios',
                        Actuator = 'eu.ownyourdata.room.actuator',
                        Verlauf  = 'eu.ownyourdata.room.log')
appStruct <- list(
        Nagios = list(
                fields      = c('name', 'nagiosUrl', 'repo', 'user', 'password', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Sensor', 'NAGIOS URL', 'Repo', 'Benutzer', 'Passwort', 'aktiv'),
                fieldWidths = c(150, 200, 150, 100, 100, 60)),
        Actuator = list(
                fields      = c('name', 'scenarios', 'params', 'command', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Aktor', 'Szenario', 'Parameter', 'Befehl', 'aktiv'),
                fieldWidths = c(150, 150, 250, 100, 60)),
        Verlauf = list(
                fields      = c('date', 'description'),
                fieldKey    = 'date',
                fieldTypes  = c('date', 'string'),
                fieldInits  = c('empty', 'empty'),
                fieldTitles = c('Datum', 'Text'),
                fieldWidths = c(150, 450)))

# appFields <- c('timestamp', 'value')
# appFieldKey <- 'timestamp'
# appFieldTypes <- c('timestamp', 'number')
# appFieldInits <- c('empty', 'empty')
# appFieldTitles <- c('Zeit', 'Wert')
# appFieldWidths <- c(100, 100)

# Version information
currVersion <- "0.3.1"
verHistory <- data.frame(rbind(
        c(version = "0.3.1",
          text    = "Verwendung von Listennamen in neuem Datentresor"),
        c(version = "0.3.0",
          text    = "erstes Release")
))

# app specific constants
sensorUiList <- vector()
actuatorUiList <- c('Dienstagabend')

scriptRepo <- 'eu.ownyourdata.room.script'
nagiosImportScript <- 'ZGVmYXVsdEhlYWRlcnMgPC0gZnVuY3Rpb24odG9rZW4pIHsNCiAgICAgICAgYygnQWNjZXB0JyAgICAgICAgPSAnKi8qJywgJ0NvbnRlbnQtVHlwZScgID0gJ2FwcGxpY2F0aW9uL2pzb24nLCAnQXV0aG9yaXphdGlvbicgPSBwYXN0ZSgnQmVhcmVyJywgdG9rZW4pKQ0KfQ0KaXRlbXNVcmwgPC0gZnVuY3Rpb24odXJsLCByZXBvX25hbWUpIHsNCiAgICAgICAgcGFzdGUwKHVybCwgJy9hcGkvcmVwb3MvJywgcmVwb19uYW1lLCAnL2l0ZW1zJykNCn0NCmdldFRva2VuIDwtIGZ1bmN0aW9uKHBpYV91cmwsIGFwcF9rZXksIGFwcF9zZWNyZXQpIHsNCiAgICAgICAgYXV0aF91cmwgPC0gcGFzdGUwKHBpYV91cmwsICcvb2F1dGgvdG9rZW4nKQ0KICAgICAgICBvcHRUaW1lb3V0IDwtIFJDdXJsOjpjdXJsT3B0aW9ucyhjb25uZWN0dGltZW91dCA9IDEwKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0oYXV0aF91cmwsIGNsaWVudF9pZCA9IGFwcF9rZXksIGNsaWVudF9zZWNyZXQgPSBhcHBfc2VjcmV0LCBncmFudF90eXBlID0gJ2NsaWVudF9jcmVkZW50aWFscycsIC5vcHRzID0gb3B0VGltZW91dCksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgaWYgKGlzLm5hKHJlc3BvbnNlKSkgew0KICAgICAgICAgICAgICAgIHJldHVybihOQSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZihqc29ubGl0ZTo6dmFsaWRhdGUocmVzcG9uc2VbMV0pKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybihyanNvbjo6ZnJvbUpTT04ocmVzcG9uc2VbMV0pJGFjY2Vzc190b2tlbikNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKE5BKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KfQ0Kc2V0dXBBcHAgPC0gZnVuY3Rpb24ocGlhX3VybCwgYXBwX2tleSwgYXBwX3NlY3JldCkgew0KICAgICAgICBhcHBfdG9rZW4gPC0gZ2V0VG9rZW4ocGlhX3VybCwgYXBwX2tleSwgYXBwX3NlY3JldCkNCiAgICAgICAgaWYoaXMubmEoYXBwX3Rva2VuKSl7DQogICAgICAgICAgICAgICAgdmVjdG9yKCkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjKCd1cmwnID0gcGlhX3VybCwgJ2FwcF9rZXknID0gYXBwX2tleSwgJ2FwcF9zZWNyZXQnID0gYXBwX3NlY3JldCwgJ3Rva2VuJyA9IGFwcF90b2tlbikNCiAgICAgICAgfQ0KfQ0KcjJkIDwtIGZ1bmN0aW9uKHJlc3BvbnNlKXsNCiAgICAgICAgaWYgKGlzLm5hKHJlc3BvbnNlKSkgew0KICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChuY2hhcihyZXNwb25zZSkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXRWYWwgPC0gcmpzb246OmZyb21KU09OKHJlc3BvbnNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobGVuZ3RoKHJldFZhbCkgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnZXJyb3InICVpbiUgbmFtZXMocmV0VmFsKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXMubnVsbChyZXRWYWwkbWVzc2FnZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXRWYWwkbWVzc2FnZSA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3IuYWNjZXNzRGVuaWVkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvLmNhbGwocmJpbmQsIGxhcHBseShyZXRWYWwsIGRhdGEuZnJhbWUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkby5jYWxsKHJiaW5kLCBsYXBwbHkocmV0VmFsLCBkYXRhLmZyYW1lKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICB9DQp9DQpyZWFkSXRlbXMgPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCkgew0KICAgICAgICBpZiAobGVuZ3RoKGFwcCkgPT0gMCkgew0KICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgIHJldHVybigpDQogICAgICAgIH0NCiAgICAgICAgaGVhZGVycyA8LSBkZWZhdWx0SGVhZGVycyhhcHBbWyd0b2tlbiddXSkNCiAgICAgICAgdXJsX2RhdGEgPC0gcGFzdGUwKHJlcG9fdXJsLCAnP3NpemU9MjAwMCcpDQogICAgICAgIGhlYWRlciA8LSBSQ3VybDo6YmFzaWNIZWFkZXJHYXRoZXJlcigpDQogICAgICAgIGRvYyA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6Z2V0VVJJKHVybF9kYXRhLCAub3B0cz1saXN0KGh0dHBoZWFkZXIgPSBoZWFkZXJzKSwgaGVhZGVyZnVuY3Rpb24gPSBoZWFkZXIkdXBkYXRlKSwNCiAgICAgICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKGUpIHsgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZSA8LSBOQQ0KICAgICAgICByZXNwRGF0YSA8LSBkYXRhLmZyYW1lKCkNCiAgICAgICAgaWYoIWlzLm5hKGRvYykpew0KICAgICAgICAgICAgICAgIHJlY3MgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgICAgICAgICBhcy5pbnRlZ2VyKGhlYWRlciR2YWx1ZSgpW1snWC1Ub3RhbC1Db3VudCddXSksDQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKGUpIHsgcmV0dXJuKDApfSkNCiAgICAgICAgICAgICAgICBpZihyZWNzID4gMjAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHBhZ2UgaW4gMDpmbG9vcihyZWNzLzIwMDApKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsX2RhdGEgPC0gcGFzdGUwKHJlcG9fdXJsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJz9wYWdlPScsIHBhZ2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnNpemU9MjAwMCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlIDwtIHRyeUNhdGNoKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJDdXJsOjpnZXRVUkwodXJsX2RhdGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub3B0cz1saXN0KGh0dHBoZWFkZXI9aGVhZGVycykpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEgPC0gcjJkKHJlc3BvbnNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihucm93KHJlc3BEYXRhKT4wKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwRGF0YSA8LSByYmluZChyZXNwRGF0YSwgc3ViRGF0YSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwRGF0YSA8LSBzdWJEYXRhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJDdXJsOjpnZXRVUkwodXJsX2RhdGEsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BEYXRhIDwtIHIyZChyZXNwb25zZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmVzcERhdGENCn0NCndyaXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpdGVtKSB7DQogICAgICAgIGhlYWRlcnMgPC0gZGVmYXVsdEhlYWRlcnMoYXBwW1sndG9rZW4nXV0pDQogICAgICAgIGRhdGEgPC0gcmpzb246OnRvSlNPTihpdGVtKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0ocmVwb191cmwsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMsIHBvc3RmaWVsZHMgPSBkYXRhKSksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZQ0KfQ0KdXBkYXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpdGVtLCBpZCkgew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBpdGVtIDwtIGMoaXRlbSwgYyhpZD1hcy5udW1lcmljKGlkKSkpDQogICAgICAgIGRhdGEgPC0gcmpzb246OnRvSlNPTihpdGVtKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0ocmVwb191cmwsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMsIHBvc3RmaWVsZHMgPSBkYXRhKSksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgcmVzcG9uc2UNCn0NCmRlbGV0ZUl0ZW0gPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCwgaWQpew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBpdGVtX3VybCA8LSBwYXN0ZTAocmVwb191cmwsICcvJywgaWQpDQogICAgICAgIHJlc3BvbnNlIDwtIHRyeUNhdGNoKA0KICAgICAgICAgICAgICAgIGh0dHI6OkRFTEVURShpdGVtX3VybCwgYWRkX2hlYWRlcnMoaGVhZGVycykpLA0KICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgIHJlc3BvbnNlDQp9DQppbXBvcnROYWdpb3MgPC0gZnVuY3Rpb24obmFnaW9zVXJsLCBhcHAsIHJlcG8sIHJlcG9OYW1lLCBuYWdpb3NVc2VyLCBuYWdpb3NQd2Qpew0KICAgICAgICBjbnQgPC0gMA0KICAgICAgICBoZGwgPC0gUkN1cmw6OmdldFVSTChuYWdpb3NVcmwsIHVzZXJwd2Q9cGFzdGUobmFnaW9zVXNlciwgbmFnaW9zUHdkLCBzZXAgPSAnOicpLCBodHRwYXV0aCA9IDFMLCBzc2wudmVyaWZ5cGVlciA9IEZBTFNFLCBzc2wudmVyaWZ5aG9zdCA9IEZBTFNFKQ0KICAgICAgICBpZih0eXBlb2YoaGRsKSA9PSAnY2hhcmFjdGVyJykgew0KICAgICAgICAgICAgICAgIGlmKGpzb25saXRlOjp2YWxpZGF0ZShoZGwpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJhdyA8LSBqc29ubGl0ZTo6ZnJvbUpTT04oaGRsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgbWV0YSA8LSByYXdbMV0kbWV0YQ0KICAgICAgICAgICAgICAgICAgICAgICAgcm93cyA8LSByYXdbMl0kZGF0YSRyb3cNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA8LSBhcy5udW1lcmljKHJvd3MkdCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA8LSB1bmxpc3QobGFwcGx5KHJvd3MkdiwgZnVuY3Rpb24oeCl7IGFzLm51bWVyaWMoeFsxXSkgfSkpDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRhIDwtIGFzLmRhdGEuZnJhbWUoY2JpbmQoc2VxLCB2YWwpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV91cmwgPC0gaXRlbXNVcmwoYXBwW1sndXJsJ11dLCByZXBvKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGlhX2RhdGEgPC0gcmVhZEl0ZW1zKGFwcCwgZGF0YV91cmwpDQogICAgICAgICAgICAgICAgICAgICAgICBpZihucm93KGRhdGEpID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihucm93KHBpYV9kYXRhKSA+IDApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1yZ19kYXRhIDwtIG1lcmdlKGRhdGEsIHBpYV9kYXRhLCBieS54PSdzZXEnLCBieS55PSd0aW1lc3RhbXAnLCBhbGwgPSBUUlVFKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1yZ19kYXRhIDwtIGRhdGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcmdfZGF0YSR2YWx1ZSA8LSBOQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1yZ19kYXRhJGlkIDwtIE5BDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5yb3cocGlhX2RhdGEpID4gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXJnX2RhdGEgPC0gcGlhX2RhdGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcmdfZGF0YSR2YWwgPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcmdfZGF0YSA8LSBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdXBkX2l0ZW1zIDwtIG1yZ19kYXRhWyhtcmdfZGF0YSR2YWwgIT0gbXJnX2RhdGEkdmFsdWUpICYgIWlzLm5hKG1yZ19kYXRhJGlkKSwgYygnaWQnLCAnc2VxJywgJ3ZhbCcpXQ0KICAgICAgICAgICAgICAgICAgICAgICAgdXBkX2l0ZW1zIDwtIHVwZF9pdGVtc1tjb21wbGV0ZS5jYXNlcyh1cGRfaXRlbXMpLCBdDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobnJvdyh1cGRfaXRlbXMpID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZpc2libGUoYXBwbHkodXBkX2l0ZW1zLCAxLCBmdW5jdGlvbih4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY250IDwtIGNudCArIDENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtIDwtIGxpc3QodGltZXN0YW1wID0geFtbJ3NlcSddXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgICAgID0geFtbJ3ZhbCddXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdW1teSA8LSB1cGRhdGVJdGVtKGFwcCwgZGF0YV91cmwsIGl0ZW0sIHhbWydpZCddXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBuZXdfaXRlbXMgPC0gbXJnX2RhdGFbKCFpcy5uYShtcmdfZGF0YSR2YWwpICYgaXMubmEobXJnX2RhdGEkdmFsdWUpKSwgYygnc2VxJywgJ3ZhbCcpXQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5yb3cobmV3X2l0ZW1zKSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52aXNpYmxlKGFwcGx5KG5ld19pdGVtcywgMSwgZnVuY3Rpb24oeCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNudCA8PC0gY250ICsgMQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPC0gbGlzdCh0aW1lc3RhbXAgPSB4W1snc2VxJ11dLCB2YWx1ZSA9IHhbWyd2YWwnXV0sICdfb3lkUmVwb05hbWUnID0gcmVwb05hbWUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVJdGVtKGFwcCwgZGF0YV91cmwsIGl0ZW0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBjbnQNCn0NCg0KcGlhX3VybCA8LSAnW3BpYV91cmxdJw0KYXBwX2tleSA8LSAnW2FwcF9rZXldJw0KYXBwX3NlY3JldCA8LSAnW2FwcF9zZWNyZXRdJw0KYXBwIDwtIHNldHVwQXBwKHBpYV91cmwsIGFwcF9rZXksIGFwcF9zZWNyZXQpDQp1cmwgPC0gaXRlbXNVcmwocGlhX3VybCwgJ2V1Lm93bnlvdXJkYXRhLnJvb20ubmFnaW9zJykNCnNlbnNvcnMgPC0gcmVhZEl0ZW1zKGFwcCwgdXJsKQ0KZm9yIChpIGluIDE6bnJvdyhzZW5zb3JzKSl7DQogICAgICAgIGltcG9ydE5hZ2lvcyhhcy5jaGFyYWN0ZXIoc2Vuc29yc1tpLCAnbmFnaW9zVXJsJ10pLCBhcHAsIGFzLmNoYXJhY3RlcihzZW5zb3JzW2ksICdyZXBvJ10pLCBhcy5jaGFyYWN0ZXIoc2Vuc29yc1tpLCAnbmFtZSddKSwgYXMuY2hhcmFjdGVyKHNlbnNvcnNbaSwgJ3VzZXInXSksIGFzLmNoYXJhY3RlcihzZW5zb3JzW2ksICdwYXNzd29yZCddKSkNCn0='
