# global constants available to the app
# last update:2016-10-08

# constants required for every app
appName <- 'room'
appTitle <- 'Raumklima'
app_id <- 'eu.ownyourdata.room'
scheduler_id <- 'eu.ownyourdata.scheduler'        

# definition of data structure
currRepoSelect <- ''
appRepos <- list(Nagios   = 'eu.ownyourdata.room.nagios',
                 Actuator = 'eu.ownyourdata.room.actuator',
                 Verlauf  = 'eu.ownyourdata.room.log')
appStruct <- list(
        Nagios = list(
                fields      = c('name', 'nagiosUrl', 'repo', 'user', 'password', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Sensor', 'NAGIOS URL', 'Repo', 'Benutzer', 'Passwort', 'aktiv'),
                fieldWidths = c(150, 200, 150, 100, 100, 60)),
        Actuator = list(
                fields      = c('name', 'scenarios', 'params', 'command', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Aktor', 'Szenario', 'Parameter', 'Befehl', 'aktiv'),
                fieldWidths = c(150, 150, 250, 100, 60)),
        Verlauf = list(
                fields      = c('date', 'description'),
                fieldKey    = 'date',
                fieldTypes  = c('date', 'string'),
                fieldInits  = c('empty', 'empty'),
                fieldTitles = c('Datum', 'Text'),
                fieldWidths = c(150, 450)))

# appFields <- c('timestamp', 'value')
# appFieldKey <- 'timestamp'
# appFieldTypes <- c('timestamp', 'number')
# appFieldInits <- c('empty', 'empty')
# appFieldTitles <- c('Zeit', 'Wert')
# appFieldWidths <- c(100, 100)

# Version information
currVersion <- "0.3.0"
verHistory <- data.frame(rbind(
        c(version = "0.3.0",
          text    = "erstes Release")
))

# app specific constants
sensorUiList <- vector()
actuatorUiList <- c('Dienstagabend')

nagiosImportScript <- 'ZGVmYXVsdEhlYWRlcnMgPC0gZnVuY3Rpb24odG9rZW4pIHsNCiAgICAgICAgYygnQWNjZXB0JyAgICAgICAgPSAnKi8qJywNCiAgICAgICAgICAnQ29udGVudC1UeXBlJyAgPSAnYXBwbGljYXRpb24vanNvbicsDQogICAgICAgICAgJ0F1dGhvcml6YXRpb24nID0gcGFzdGUoJ0JlYXJlcicsIHRva2VuKSkNCn0NCml0ZW1zVXJsIDwtIGZ1bmN0aW9uKHVybCwgcmVwb19uYW1lKSB7DQogICAgICAgIHBhc3RlMCh1cmwsICcvYXBpL3JlcG9zLycsIHJlcG9fbmFtZSwgJy9pdGVtcycpDQp9DQpnZXRUb2tlbiA8LSBmdW5jdGlvbihwaWFfdXJsLCBhcHBfa2V5LCBhcHBfc2VjcmV0KSB7DQogICAgICAgIGF1dGhfdXJsIDwtIHBhc3RlMChwaWFfdXJsLCAnL29hdXRoL3Rva2VuJykNCiAgICAgICAgb3B0VGltZW91dCA8LSBSQ3VybDo6Y3VybE9wdGlvbnMoY29ubmVjdHRpbWVvdXQgPSAxMCkNCiAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgUkN1cmw6OnBvc3RGb3JtKGF1dGhfdXJsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQgICAgID0gYXBwX2tleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50X3NlY3JldCA9IGFwcF9zZWNyZXQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyYW50X3R5cGUgICAgPSAnY2xpZW50X2NyZWRlbnRpYWxzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9wdHMgICAgICAgICA9IG9wdFRpbWVvdXQpLA0KICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgIGlmIChpcy5uYShyZXNwb25zZSkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4oTkEpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYoanNvbmxpdGU6OnZhbGlkYXRlKHJlc3BvbnNlWzFdKSl7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ocmpzb246OmZyb21KU09OKHJlc3BvbnNlWzFdKSRhY2Nlc3NfdG9rZW4pDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybihOQSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgIH0NCn0NCnNldHVwQXBwIDwtIGZ1bmN0aW9uKHBpYV91cmwsIGFwcF9rZXksIGFwcF9zZWNyZXQpIHsNCiAgICAgICAgYXBwX3Rva2VuIDwtIGdldFRva2VuKHBpYV91cmwsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwX2tleSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBfc2VjcmV0KQ0KICAgICAgICBpZihpcy5uYShhcHBfdG9rZW4pKXsNCiAgICAgICAgICAgICAgICB2ZWN0b3IoKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGMoJ3VybCcgICAgICAgID0gcGlhX3VybCwNCiAgICAgICAgICAgICAgICAgICdhcHBfa2V5JyAgICA9IGFwcF9rZXksDQogICAgICAgICAgICAgICAgICAnYXBwX3NlY3JldCcgPSBhcHBfc2VjcmV0LA0KICAgICAgICAgICAgICAgICAgJ3Rva2VuJyAgICAgID0gYXBwX3Rva2VuKQ0KICAgICAgICB9DQp9DQpyMmQgPC0gZnVuY3Rpb24ocmVzcG9uc2Upew0KICAgICAgICBpZiAoaXMubmEocmVzcG9uc2UpKSB7DQogICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKG5jaGFyKHJlc3BvbnNlKSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldFZhbCA8LSByanNvbjo6ZnJvbUpTT04ocmVzcG9uc2UpDQogICAgICAgICAgICAgICAgICAgICAgICBpZihsZW5ndGgocmV0VmFsKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdlcnJvcicgJWluJSBuYW1lcyhyZXRWYWwpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpcy5udWxsKHJldFZhbCRtZXNzYWdlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldFZhbCRtZXNzYWdlID09IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlcnJvci5hY2Nlc3NEZW5pZWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG8uY2FsbChyYmluZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFwcGx5KHJldFZhbCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkby5jYWxsKHJiaW5kLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFwcGx5KHJldFZhbCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZyYW1lKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICB9DQp9DQpyZWFkSXRlbXMgPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCkgew0KICAgICAgICBpZiAobGVuZ3RoKGFwcCkgPT0gMCkgew0KICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgIHJldHVybigpDQogICAgICAgIH0NCiAgICAgICAgaGVhZGVycyA8LSBkZWZhdWx0SGVhZGVycyhhcHBbWyd0b2tlbiddXSkNCiAgICAgICAgdXJsX2RhdGEgPC0gcGFzdGUwKHJlcG9fdXJsLCAnP3NpemU9MjAwMCcpDQogICAgICAgIGhlYWRlciA8LSBSQ3VybDo6YmFzaWNIZWFkZXJHYXRoZXJlcigpDQogICAgICAgIGRvYyA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6Z2V0VVJJKHVybF9kYXRhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9wdHM9bGlzdChodHRwaGVhZGVyID0gaGVhZGVycyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJmdW5jdGlvbiA9IGhlYWRlciR1cGRhdGUpLA0KICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgIHJlc3BvbnNlIDwtIE5BDQogICAgICAgIHJlc3BEYXRhIDwtIGRhdGEuZnJhbWUoKQ0KICAgICAgICBpZighaXMubmEoZG9jKSl7DQogICAgICAgICAgICAgICAgcmVjcyA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICAgICAgICAgIGFzLmludGVnZXIoaGVhZGVyJHZhbHVlKClbWydYLVRvdGFsLUNvdW50J11dKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oMCl9KQ0KICAgICAgICAgICAgICAgIGlmKHJlY3MgPiAyMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IocGFnZSBpbiAwOmZsb29yKHJlY3MvMjAwMCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmxfZGF0YSA8LSBwYXN0ZTAocmVwb191cmwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnP3BhZ2U9JywgcGFnZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmc2l6ZT0yMDAwJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkN1cmw6OmdldFVSTCh1cmxfZGF0YSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vcHRzPWxpc3QoaHR0cGhlYWRlcj1oZWFkZXJzKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YSA8LSByMmQocmVzcG9uc2UpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5yb3cocmVzcERhdGEpPjApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BEYXRhIDwtIHJiaW5kKHJlc3BEYXRhLCBzdWJEYXRhKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BEYXRhIDwtIHN1YkRhdGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkN1cmw6OmdldFVSTCh1cmxfZGF0YSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub3B0cz1saXN0KGh0dHBoZWFkZXIgPSBoZWFkZXJzKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgICAgICAgICAgICAgICAgICByZXNwRGF0YSA8LSByMmQocmVzcG9uc2UpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJlc3BEYXRhDQp9DQp3cml0ZUl0ZW0gPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCwgaXRlbSkgew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBkYXRhIDwtIHJqc29uOjp0b0pTT04oaXRlbSkNCiAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgUkN1cmw6OnBvc3RGb3JtKHJlcG9fdXJsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub3B0cz1saXN0KGh0dHBoZWFkZXIgPSBoZWFkZXJzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RmaWVsZHMgPSBkYXRhKSksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZQ0KfQ0KdXBkYXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpdGVtLCBpZCkgew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBpdGVtIDwtIGMoaXRlbSwgYyhpZD1hcy5udW1lcmljKGlkKSkpDQogICAgICAgIGRhdGEgPC0gcmpzb246OnRvSlNPTihpdGVtKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0ocmVwb191cmwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdGZpZWxkcyA9IGRhdGEpKSwNCiAgICAgICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKGUpIHsgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZQ0KfQ0KZGVsZXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpZCl7DQogICAgICAgIGhlYWRlcnMgPC0gZGVmYXVsdEhlYWRlcnMoYXBwW1sndG9rZW4nXV0pDQogICAgICAgIGl0ZW1fdXJsIDwtIHBhc3RlMChyZXBvX3VybCwgJy8nLCBpZCkNCiAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgaHR0cjo6REVMRVRFKGl0ZW1fdXJsLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2hlYWRlcnMoaGVhZGVycykpLA0KICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgIHJlc3BvbnNlDQp9DQpwaWFfdXJsIDwtICdbcGlhX3VybF0nDQphcHBfa2V5IDwtICdbYXBwX2tleV0nDQphcHBfc2VjcmV0IDwtICdbYXBwX3NlY3JldF0nDQphcHAgPC0gc2V0dXBBcHAocGlhX3VybCwgYXBwX2tleSwgYXBwX3NlY3JldCkNCnVybCA8LSBpdGVtc1VybChwaWFfdXJsLCAnZXUub3dueW91cmRhdGEucm9vbS5odW0xJykNCmRhdCA8LSBsaXN0KHRpbWVzdGFtcCA9IDE0NzYyMzg5MjAsDQogICAgICAgICAgICB2YWx1ZSA9IDIzLjUxKQ0KcmVzdWx0IDwtIHdyaXRlSXRlbShhcHAsIHVybCwgZGF0KQ=='
