# global constants available to the app
# last update:2016-10-08

# constants required for every app
appName <- 'room'
appTitle <- 'Raumklima'
app_id <- 'eu.ownyourdata.room'
scheduler_id <- 'eu.ownyourdata.scheduler'        

# definition of data structure
currRepoSelect <- ''
appRepos <- list()
appReposDefault <- list(Nagios   = 'eu.ownyourdata.room.nagios',
                        Actuator = 'eu.ownyourdata.room.actuator',
                        Verlauf  = 'eu.ownyourdata.room.log')
appStruct <- list(
        Nagios = list(
                fields      = c('name', 'nagiosUrl', 'repo', 'user', 'password', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Sensor', 'NAGIOS URL', 'Repo', 'Benutzer', 'Passwort', 'aktiv'),
                fieldWidths = c(150, 200, 150, 100, 100, 60)),
        Actuator = list(
                fields      = c('name', 'scenarios', 'params', 'command', 'active'),
                fieldKey    = 'name',
                fieldTypes  = c('string', 'string', 'string', 'string', 'boolean'),
                fieldInits  = c('empty', 'empty', 'empty', 'empty', 'false'),
                fieldTitles = c('Aktor', 'Szenario', 'Parameter', 'Befehl', 'aktiv'),
                fieldWidths = c(150, 150, 250, 100, 60)),
        Verlauf = list(
                fields      = c('date', 'description'),
                fieldKey    = 'date',
                fieldTypes  = c('date', 'string'),
                fieldInits  = c('empty', 'empty'),
                fieldTitles = c('Datum', 'Text'),
                fieldWidths = c(150, 450)))

# appFields <- c('timestamp', 'value')
# appFieldKey <- 'timestamp'
# appFieldTypes <- c('timestamp', 'number')
# appFieldInits <- c('empty', 'empty')
# appFieldTitles <- c('Zeit', 'Wert')
# appFieldWidths <- c(100, 100)

# Version information
currVersion <- "0.3.1"
verHistory <- data.frame(rbind(
        c(version = "0.3.1",
          text    = "Verwendung von Listennamen in neuem Datentresor"),
        c(version = "0.3.0",
          text    = "erstes Release")
))

# app specific constants
sensorUiList <- vector()
actuatorUiList <- c('Dienstagabend')

scriptRepo <- 'eu.ownyourdata.room.script'
nagiosImportScript <- 'ZGVmYXVsdEhlYWRlcnMgPC0gZnVuY3Rpb24odG9rZW4pIHsNCiAgYygnQWNjZXB0JyAgICAgICAgPSAnKi8qJywgJ0NvbnRlbnQtVHlwZScgID0gJ2FwcGxpY2F0aW9uL2pzb24nLCAnQXV0aG9yaXphdGlvbicgPSBwYXN0ZSgnQmVhcmVyJywgdG9rZW4pKQ0KfQ0KaXRlbXNVcmwgPC0gZnVuY3Rpb24odXJsLCByZXBvX25hbWUpIHsNCiAgcGFzdGUwKHVybCwgJy9hcGkvcmVwb3MvJywgcmVwb19uYW1lLCAnL2l0ZW1zJykNCn0NCmdldFRva2VuIDwtIGZ1bmN0aW9uKHBpYV91cmwsIGFwcF9rZXksIGFwcF9zZWNyZXQpIHsNCiAgICAgICAgYXV0aF91cmwgPC0gcGFzdGUwKHBpYV91cmwsICcvb2F1dGgvdG9rZW4nKQ0KICAgICAgICBvcHRUaW1lb3V0IDwtIFJDdXJsOjpjdXJsT3B0aW9ucyhjb25uZWN0dGltZW91dCA9IDEwKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0oYXV0aF91cmwsIGNsaWVudF9pZCA9IGFwcF9rZXksIGNsaWVudF9zZWNyZXQgPSBhcHBfc2VjcmV0LCBncmFudF90eXBlID0gJ2NsaWVudF9jcmVkZW50aWFscycsIC5vcHRzID0gb3B0VGltZW91dCksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgaWYgKGlzLm5hKHJlc3BvbnNlKSkgew0KICAgICAgICAgICAgICAgIHJldHVybihOQSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZihqc29ubGl0ZTo6dmFsaWRhdGUocmVzcG9uc2VbMV0pKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybihyanNvbjo6ZnJvbUpTT04ocmVzcG9uc2VbMV0pJGFjY2Vzc190b2tlbikNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKE5BKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KfQ0Kc2V0dXBBcHAgPC0gZnVuY3Rpb24ocGlhX3VybCwgYXBwX2tleSwgYXBwX3NlY3JldCkgew0KICAgICAgICBhcHBfdG9rZW4gPC0gZ2V0VG9rZW4ocGlhX3VybCwgYXBwX2tleSwgYXBwX3NlY3JldCkNCiAgICAgICAgaWYoaXMubmEoYXBwX3Rva2VuKSl7DQogICAgICAgICAgICAgICAgdmVjdG9yKCkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjKCd1cmwnID0gcGlhX3VybCwgJ2FwcF9rZXknID0gYXBwX2tleSwgJ2FwcF9zZWNyZXQnID0gYXBwX3NlY3JldCwgJ3Rva2VuJyA9IGFwcF90b2tlbikNCiAgICAgICAgfQ0KfQ0KcjJkIDwtIGZ1bmN0aW9uKHJlc3BvbnNlKXsNCiAgICAgICAgaWYgKGlzLm5hKHJlc3BvbnNlKSkgew0KICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmIChuY2hhcihyZXNwb25zZSkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXRWYWwgPC0gcmpzb246OmZyb21KU09OKHJlc3BvbnNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobGVuZ3RoKHJldFZhbCkgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnZXJyb3InICVpbiUgbmFtZXMocmV0VmFsKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXMubnVsbChyZXRWYWwkbWVzc2FnZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXRWYWwkbWVzc2FnZSA9PSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3IuYWNjZXNzRGVuaWVkJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvLmNhbGwocmJpbmQsIGxhcHBseShyZXRWYWwsIGRhdGEuZnJhbWUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkby5jYWxsKHJiaW5kLCBsYXBwbHkocmV0VmFsLCBkYXRhLmZyYW1lKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICB9DQp9DQpyZWFkSXRlbXMgPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCkgew0KICAgICAgICBpZiAobGVuZ3RoKGFwcCkgPT0gMCkgew0KICAgICAgICAgICAgICAgIGRhdGEuZnJhbWUoKQ0KICAgICAgICAgICAgICAgIHJldHVybigpDQogICAgICAgIH0NCiAgICAgICAgaGVhZGVycyA8LSBkZWZhdWx0SGVhZGVycyhhcHBbWyd0b2tlbiddXSkNCiAgICAgICAgdXJsX2RhdGEgPC0gcGFzdGUwKHJlcG9fdXJsLCAnP3NpemU9MjAwMCcpDQogICAgICAgIGhlYWRlciA8LSBSQ3VybDo6YmFzaWNIZWFkZXJHYXRoZXJlcigpDQogICAgICAgIGRvYyA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6Z2V0VVJJKHVybF9kYXRhLCAub3B0cz1saXN0KGh0dHBoZWFkZXIgPSBoZWFkZXJzKSwgaGVhZGVyZnVuY3Rpb24gPSBoZWFkZXIkdXBkYXRlKSwNCiAgICAgICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKGUpIHsgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZSA8LSBOQQ0KICAgICAgICByZXNwRGF0YSA8LSBkYXRhLmZyYW1lKCkNCiAgICAgICAgaWYoIWlzLm5hKGRvYykpew0KICAgICAgICAgICAgICAgIHJlY3MgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgICAgICAgICBhcy5pbnRlZ2VyKGhlYWRlciR2YWx1ZSgpW1snWC1Ub3RhbC1Db3VudCddXSksDQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKGUpIHsgcmV0dXJuKDApfSkNCiAgICAgICAgICAgICAgICBpZihyZWNzID4gMjAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHBhZ2UgaW4gMDpmbG9vcihyZWNzLzIwMDApKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsX2RhdGEgPC0gcGFzdGUwKHJlcG9fdXJsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJz9wYWdlPScsIHBhZ2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnNpemU9MjAwMCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlIDwtIHRyeUNhdGNoKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJDdXJsOjpnZXRVUkwodXJsX2RhdGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub3B0cz1saXN0KGh0dHBoZWFkZXI9aGVhZGVycykpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEgPC0gcjJkKHJlc3BvbnNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihucm93KHJlc3BEYXRhKT4wKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwRGF0YSA8LSByYmluZChyZXNwRGF0YSwgc3ViRGF0YSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwRGF0YSA8LSBzdWJEYXRhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPC0gdHJ5Q2F0Y2goDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJDdXJsOjpnZXRVUkwodXJsX2RhdGEsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BEYXRhIDwtIHIyZChyZXNwb25zZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmVzcERhdGENCn0NCndyaXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpdGVtKSB7DQogICAgICAgIGhlYWRlcnMgPC0gZGVmYXVsdEhlYWRlcnMoYXBwW1sndG9rZW4nXV0pDQogICAgICAgIGRhdGEgPC0gcmpzb246OnRvSlNPTihpdGVtKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0ocmVwb191cmwsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMsIHBvc3RmaWVsZHMgPSBkYXRhKSksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuKE5BKSB9KQ0KICAgICAgICByZXNwb25zZQ0KfQ0KdXBkYXRlSXRlbSA8LSBmdW5jdGlvbihhcHAsIHJlcG9fdXJsLCBpdGVtLCBpZCkgew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBpdGVtIDwtIGMoaXRlbSwgYyhpZD1hcy5udW1lcmljKGlkKSkpDQogICAgICAgIGRhdGEgPC0gcmpzb246OnRvSlNPTihpdGVtKQ0KICAgICAgICByZXNwb25zZSA8LSB0cnlDYXRjaCgNCiAgICAgICAgICAgICAgICBSQ3VybDo6cG9zdEZvcm0ocmVwb191cmwsIC5vcHRzPWxpc3QoaHR0cGhlYWRlciA9IGhlYWRlcnMsIHBvc3RmaWVsZHMgPSBkYXRhKSksDQogICAgICAgICAgICAgICAgZXJyb3IgPSBmdW5jdGlvbihlKSB7IHJldHVybihOQSkgfSkNCiAgICAgICAgcmVzcG9uc2UNCn0NCmRlbGV0ZUl0ZW0gPC0gZnVuY3Rpb24oYXBwLCByZXBvX3VybCwgaWQpew0KICAgICAgICBoZWFkZXJzIDwtIGRlZmF1bHRIZWFkZXJzKGFwcFtbJ3Rva2VuJ11dKQ0KICAgICAgICBpdGVtX3VybCA8LSBwYXN0ZTAocmVwb191cmwsICcvJywgaWQpDQogICAgICAgIHJlc3BvbnNlIDwtIHRyeUNhdGNoKA0KICAgICAgICAgICAgICAgIGh0dHI6OkRFTEVURShpdGVtX3VybCwgYWRkX2hlYWRlcnMoaGVhZGVycykpLA0KICAgICAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24oZSkgeyByZXR1cm4oTkEpIH0pDQogICAgICAgIHJlc3BvbnNlDQp9DQppbXBvcnROYWdpb3MgPC0gZnVuY3Rpb24obmFnaW9zVXJsLCBhcHAsIHJlcG8sIHJlcG9OYW1lLCBuYWdpb3NVc2VyLCBuYWdpb3NQd2Qpew0KICAgICAgICBjbnQgPC0gMA0KICAgICAgICBoZGwgPC0gUkN1cmw6OmdldFVSTChuYWdpb3NVcmwsIHVzZXJwd2Q9cGFzdGUobmFnaW9zVXNlciwgbmFnaW9zUHdkLCBzZXAgPSAnOicpLCBodHRwYXV0aCA9IDFMLCBzc2wudmVyaWZ5cGVlciA9IEZBTFNFKQ0KICAgICAgICBpZih0eXBlb2YoaGRsKSA9PSAnY2hhcmFjdGVyJykgew0KICAgICAgICAgICAgICAgIHJhdyA8LSBqc29ubGl0ZTo6ZnJvbUpTT04oaGRsKQ0KICAgICAgICAgICAgICAgIG1ldGEgPC0gcmF3WzFdJG1ldGENCiAgICAgICAgICAgICAgICByb3dzIDwtIHJhd1syXSRkYXRhJHJvdw0KICAgICAgICAgICAgICAgIHNlcSA8LSBhcy5udW1lcmljKHJvd3MkdCkNCiAgICAgICAgICAgICAgICB2YWwgPC0gdW5saXN0KGxhcHBseShyb3dzJHYsIGZ1bmN0aW9uKHgpeyBhcy5udW1lcmljKHhbMV0pIH0pKQ0KICAgICAgICAgICAgICAgIGRhdGEgPC0gYXMuZGF0YS5mcmFtZShjYmluZChzZXEsIHZhbCkpDQogICAgICAgICAgICAgICAgZGF0YV91cmwgPC0gaXRlbXNVcmwoYXBwW1sndXJsJ11dLCByZXBvKQ0KICAgICAgICAgICAgICAgIHBpYV9kYXRhIDwtIHJlYWRJdGVtcyhhcHAsIGRhdGFfdXJsKQ0KICAgICAgICAgICAgICAgIGlmKG5yb3coZGF0YSkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihucm93KHBpYV9kYXRhKSA+IDApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcmdfZGF0YSA8LSBtZXJnZShkYXRhLCBwaWFfZGF0YSwgYnkueD0nc2VxJywgYnkueT0ndGltZXN0YW1wJywgYWxsID0gVFJVRSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1yZ19kYXRhIDwtIGRhdGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXJnX2RhdGEkdmFsdWUgPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXJnX2RhdGEkaWQgPC0gTkENCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobnJvdyhwaWFfZGF0YSkgPiAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXJnX2RhdGEgPC0gcGlhX2RhdGENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXJnX2RhdGEkdmFsIDwtIE5BDQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcmdfZGF0YSA8LSBkYXRhLmZyYW1lKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdXBkX2l0ZW1zIDwtIG1yZ19kYXRhWyhtcmdfZGF0YSR2YWwgIT0gbXJnX2RhdGEkdmFsdWUpICYgIWlzLm5hKG1yZ19kYXRhJGlkKSwgYygnaWQnLCAnc2VxJywgJ3ZhbCcpXQ0KICAgICAgICAgICAgICAgIHVwZF9pdGVtcyA8LSB1cGRfaXRlbXNbY29tcGxldGUuY2FzZXModXBkX2l0ZW1zKSwgXQ0KICAgICAgICAgICAgICAgIGlmIChucm93KHVwZF9pdGVtcykgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnZpc2libGUoYXBwbHkodXBkX2l0ZW1zLCAxLCBmdW5jdGlvbih4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNudCA8LSBjbnQgKyAxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPC0gbGlzdCh0aW1lc3RhbXAgPSB4W1snc2VxJ11dLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgICAgID0geFtbJ3ZhbCddXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtbXkgPC0gdXBkYXRlSXRlbShhcHAsIGRhdGFfdXJsLCBpdGVtLCB4W1snaWQnXV0pDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgbmV3X2l0ZW1zIDwtIG1yZ19kYXRhWyghaXMubmEobXJnX2RhdGEkdmFsKSAmIGlzLm5hKG1yZ19kYXRhJHZhbHVlKSksIGMoJ3NlcScsICd2YWwnKV0NCiAgICAgICAgICAgICAgICBpZiAobnJvdyhuZXdfaXRlbXMpID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW52aXNpYmxlKGFwcGx5KG5ld19pdGVtcywgMSwgZnVuY3Rpb24oeCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbnQgPDwtIGNudCArIDENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA8LSBsaXN0KHRpbWVzdGFtcCA9IHhbWydzZXEnXV0sIHZhbHVlID0geFtbJ3ZhbCddXSwgJ19veWRSZXBvTmFtZScgPSByZXBvTmFtZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVJdGVtKGFwcCwgZGF0YV91cmwsIGl0ZW0pDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY250DQp9DQoNCnBpYV91cmwgPC0gJ1twaWFfdXJsXScNCmFwcF9rZXkgPC0gJ1thcHBfa2V5XScNCmFwcF9zZWNyZXQgPC0gJ1thcHBfc2VjcmV0XScNCmFwcCA8LSBzZXR1cEFwcChwaWFfdXJsLCBhcHBfa2V5LCBhcHBfc2VjcmV0KQ0KdXJsIDwtIGl0ZW1zVXJsKHBpYV91cmwsICdldS5vd255b3VyZGF0YS5yb29tLm5hZ2lvcycpDQpzZW5zb3JzIDwtIHJlYWRJdGVtcyhhcHAsIHVybCkNCmZvciAoaSBpbiAxOm5yb3coc2Vuc29ycykpew0KICAgICAgICBpbXBvcnROYWdpb3MoYXMuY2hhcmFjdGVyKHNlbnNvcnNbaSwgJ25hZ2lvc1VybCddKSwgYXBwLCBhcy5jaGFyYWN0ZXIoc2Vuc29yc1tpLCAncmVwbyddKSwgYXMuY2hhcmFjdGVyKHNlbnNvcnNbaSwgJ25hbWUnXSksIGFzLmNoYXJhY3RlcihzZW5zb3JzW2ksICd1c2VyJ10pLCBhcy5jaGFyYWN0ZXIoc2Vuc29yc1tpLCAncGFzc3dvcmQnXSkpDQp9'
